########################################
# Application
########################################
spring:
  application:
    name: prodwebapp

  # 콘솔에 ANSI 컬러 항상 사용
  output:
    ansi:
      enabled: always

  ########################################
  # DevTools (DEV 전용 권장)
  # build.gradle 추가 => developmentOnly 'org.springframework.boot:spring-boot-devtools'
  ########################################
  devtools:
    restart:
      enabled: true
      poll-interval: 2s
      quiet-period: 1s
    livereload:
      enabled: true

  ########################################
  # Encoding
  ########################################
  servlet:
    encoding:
      charset: UTF-8
      enabled: true
      force: true

  ########################################
  # DataSource
  ########################################
  datasource:
    url: jdbc:mysql://localhost:3306/cinema?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&connectTimeout=5000&socketTimeout=5000&allowPublicKeyRetrieval=true
    username: cinema_user
    password: cinema_26118791
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      initialization-fail-timeout: -1       # DB 연결 실패해도 서버 시작
      connection-timeout: 5000              # 연결 타임아웃 5초
      maximum-pool-size: 10
      minimum-idle: 2

  ########################################
  # JPA
  ########################################
  jpa:
    open-in-view: false
    defer-datasource-initialization: true   # DataSource 초기화 지연
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect  # Hibernate 7.x용 dialect

  ########################################
  # SQL Init
  ########################################
  sql:
    init:
      mode: never                           # SQL 초기화 스크립트 실행 안 함
      continue-on-error: true               # 초기화 에러 시 계속 진행

  ########################################
  # Redis
  ########################################
  data:
    redis:
      host: localhost
      port: 6379
      timeout: 2000ms
      connect-timeout: 5000ms

  ########################################
  # Error Handling
  ########################################
  web:
    error:
      include-message: always
      include-binding-errors: always
      include-stacktrace: on_param

########################################
# Server
########################################
server:
  port: 8080

########################################
# Logging
########################################
logging:
  level:
    root: INFO
    com.cinema: DEBUG
    org.springframework: INFO
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.orm.jdbc.bind: TRACE

########################################
# JWT
########################################
jwt:
  secret: dGhpc2lzYXZlcnlsb25nc2VjcmV0a2V5Zm9yamF2YXdlYnRva2Vuc2lnbmluZ3B1cnBvc2Vz
  access-token-expire-time: 900000     # 15분 (밀리초) - RULE: Access Token ≤ 15분
  refresh-token-expire-time: 604800000 # 7일 (밀리초)

########################################
# CORS
########################################
cors:
  allowed-origins: "*"                 # 개발 환경: 모든 origin 허용 (운영 시 특정 도메인으로 변경)
  max-age: 3600                        # Preflight 요청 캐시 시간 (초)

########################################
# Seat HOLD
########################################
seat:
  hold:
    ttl-minutes: 7                     # HOLD TTL (5~10분 권장)
    max-seats-per-user: 4              # 사용자당 최대 선택 가능 좌석 수
